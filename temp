{
   "$schema":"https://vega.github.io/schema/vega-lite/v4.json",
   "vconcat":[
      {
         "hconcat":[
            {
               "layer":[
                  {
                     "mark":{
                        "type":"point",
                        "filled":true
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Services != 0 && datum.Services != null&& datum[\"income-group\"] != null"
                        }
                     ],
                     "encoding":{
                        "x":{
                           "field":"economic-fitness",
                           "type":"quantitative",
                           "axis":{
                              "title":null
                           },
                           "scale":{
                              "type":"sqrt"
                           }
                        },
                        "y":{
                           "field":"Services",
                           "type":"quantitative",
                           "axis":{
                              "grid":false
                           },
                           "scale":{
                              "zero":false
                           }
                        },
                        "size":{
                           "field":"GDP",
                           "type":"quantitative",
                           "legend":null,
                           "scale":{
                              "range":[
                                 10,
                                 1000
                              ]
                           }
                        },
                        "tooltip":[
                           {
                              "field":"Country Name",
                              "type":"nominal"
                           },
                           {
                              "field":"GDP",
                              "type":"nominal"
                           },
                           {
                              "field":"Services",
                              "type":"nominal"
                           },
                           {
                              "field":"economic-fitness",
                              "type":"nominal"
                           }
                        ]
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  },
                  {
                     "mark":{
                        "type":"line",
                        "color":"firebrick"
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Services != 0 && datum.Services != null&& datum[\"income-group\"] != null"
                        },
                        {
                           "regression":"Services",
                           "method":"exp",
                           "on":"economic-fitness",
                           "as":[
                              "regress-x",
                              "regress-y"
                           ]
                        }
                     ],
                     "encoding":{
                        "x":{
                           "field":"regress-x",
                           "type":"quantitative",
                           "axis":{
                              "title":null
                           },
                           "scale":{
                              "type":"sqrt"
                           }
                        },
                        "y":{
                           "field":"regress-y",
                           "type":"quantitative",
                           "axis":{
                              "grid":false
                           },
                           "scale":{
                              "zero":false
                           }
                        }
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  },
                  {
                     "mark":{
                        "type":"text",
                        "x":"width",
                        "y":-5,
                        "align":"right"
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Services != 0 && datum.Services != null&& datum[\"income-group\"] != null"
                        },
                        {
                           "regression":"Services",
                           "on":"economic-fitness",
                           "params":true
                        },
                        {
                           "calculate":"'R²: '+format(datum.rSquared, '.2f')",
                           "as":"R2"
                        }
                     ],
                     "encoding":{
                        "text":{
                           "field":"R2",
                           "type":"nominal"
                        }
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  }
               ]
            },
            {
               "layer":[
                  {
                     "mark":{
                        "type":"point",
                        "filled":true
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Manufacturing != 0 && datum.Manufacturing != null&& datum[\"income-group\"] != null"
                        }
                     ],
                     "encoding":{
                        "x":{
                           "field":"economic-fitness",
                           "type":"quantitative",
                           "axis":{
                              "title":null
                           },
                           "scale":{
                              "type":"sqrt"
                           }
                        },
                        "y":{
                           "field":"Manufacturing",
                           "type":"quantitative",
                           "axis":{
                              "grid":false
                           },
                           "scale":{
                              "zero":false
                           }
                        },
                        "size":{
                           "field":"GDP",
                           "type":"quantitative",
                           "legend":null,
                           "scale":{
                              "range":[
                                 10,
                                 1000
                              ]
                           }
                        },
                        "tooltip":[
                           {
                              "field":"Country Name",
                              "type":"nominal"
                           },
                           {
                              "field":"GDP",
                              "type":"nominal"
                           },
                           {
                              "field":"Manufacturing",
                              "type":"nominal"
                           },
                           {
                              "field":"economic-fitness",
                              "type":"nominal"
                           }
                        ]
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  },
                  {
                     "mark":{
                        "type":"line",
                        "color":"firebrick"
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Manufacturing != 0 && datum.Manufacturing != null&& datum[\"income-group\"] != null"
                        },
                        {
                           "regression":"Manufacturing",
                           "method":"exp",
                           "on":"economic-fitness",
                           "as":[
                              "regress-x",
                              "regress-y"
                           ]
                        }
                     ],
                     "encoding":{
                        "x":{
                           "field":"regress-x",
                           "type":"quantitative",
                           "axis":{
                              "title":null
                           },
                           "scale":{
                              "type":"sqrt"
                           }
                        },
                        "y":{
                           "field":"regress-y",
                           "type":"quantitative",
                           "axis":{
                              "grid":false
                           },
                           "scale":{
                              "zero":false
                           }
                        }
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  },
                  {
                     "mark":{
                        "type":"text",
                        "x":"width",
                        "y":-5,
                        "align":"right"
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Manufacturing != 0 && datum.Manufacturing != null&& datum[\"income-group\"] != null"
                        },
                        {
                           "regression":"Manufacturing",
                           "on":"economic-fitness",
                           "params":true
                        },
                        {
                           "calculate":"'R²: '+format(datum.rSquared, '.2f')",
                           "as":"R2"
                        }
                     ],
                     "encoding":{
                        "text":{
                           "field":"R2",
                           "type":"nominal"
                        }
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  }
               ]
            }
         ]
      },
      {
         "hconcat":[
            {
               "layer":[
                  {
                     "mark":{
                        "type":"point",
                        "filled":true
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Industry != 0 && datum.Industry != null&& datum[\"income-group\"] != null"
                        }
                     ],
                     "encoding":{
                        "x":{
                           "field":"economic-fitness",
                           "type":"quantitative",
                           "axis":{
                              "title":null
                           },
                           "scale":{
                              "type":"sqrt"
                           }
                        },
                        "y":{
                           "field":"Industry",
                           "type":"quantitative",
                           "axis":{
                              "grid":false
                           },
                           "scale":{
                              "zero":false
                           }
                        },
                        "size":{
                           "field":"GDP",
                           "type":"quantitative",
                           "legend":null,
                           "scale":{
                              "range":[
                                 10,
                                 1000
                              ]
                           }
                        },
                        "tooltip":[
                           {
                              "field":"Country Name",
                              "type":"nominal"
                           },
                           {
                              "field":"GDP",
                              "type":"nominal"
                           },
                           {
                              "field":"Industry",
                              "type":"nominal"
                           },
                           {
                              "field":"economic-fitness",
                              "type":"nominal"
                           }
                        ]
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  },
                  {
                     "mark":{
                        "type":"line",
                        "color":"firebrick"
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Industry != 0 && datum.Industry != null&& datum[\"income-group\"] != null"
                        },
                        {
                           "regression":"Industry",
                           "method":"exp",
                           "on":"economic-fitness",
                           "as":[
                              "regress-x",
                              "regress-y"
                           ]
                        }
                     ],
                     "encoding":{
                        "x":{
                           "field":"regress-x",
                           "type":"quantitative",
                           "axis":{
                              "title":null
                           },
                           "scale":{
                              "type":"sqrt"
                           }
                        },
                        "y":{
                           "field":"regress-y",
                           "type":"quantitative",
                           "axis":{
                              "grid":false
                           },
                           "scale":{
                              "zero":false
                           }
                        }
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  },
                  {
                     "mark":{
                        "type":"text",
                        "x":"width",
                        "y":-5,
                        "align":"right"
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Industry != 0 && datum.Industry != null&& datum[\"income-group\"] != null"
                        },
                        {
                           "regression":"Industry",
                           "on":"economic-fitness",
                           "params":true
                        },
                        {
                           "calculate":"'R²: '+format(datum.rSquared, '.2f')",
                           "as":"R2"
                        }
                     ],
                     "encoding":{
                        "text":{
                           "field":"R2",
                           "type":"nominal"
                        }
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  }
               ]
            },
            {
               "layer":[
                  {
                     "mark":{
                        "type":"point",
                        "filled":true
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Agriculture != 0 && datum.Agriculture != null&& datum[\"income-group\"] != null"
                        }
                     ],
                     "encoding":{
                        "x":{
                           "field":"economic-fitness",
                           "type":"quantitative",
                           "axis":{
                              "title":null
                           },
                           "scale":{
                              "type":"sqrt"
                           }
                        },
                        "y":{
                           "field":"Agriculture",
                           "type":"quantitative",
                           "axis":{
                              "grid":false
                           },
                           "scale":{
                              "zero":false
                           }
                        },
                        "size":{
                           "field":"GDP",
                           "type":"quantitative",
                           "legend":null,
                           "scale":{
                              "range":[
                                 10,
                                 1000
                              ]
                           }
                        },
                        "tooltip":[
                           {
                              "field":"Country Name",
                              "type":"nominal"
                           },
                           {
                              "field":"GDP",
                              "type":"nominal"
                           },
                           {
                              "field":"Agriculture",
                              "type":"nominal"
                           },
                           {
                              "field":"economic-fitness",
                              "type":"nominal"
                           }
                        ]
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  },
                  {
                     "mark":{
                        "type":"line",
                        "color":"firebrick"
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Agriculture != 0 && datum.Agriculture != null&& datum[\"income-group\"] != null"
                        },
                        {
                           "regression":"Agriculture",
                           "method":"exp",
                           "on":"economic-fitness",
                           "as":[
                              "regress-x",
                              "regress-y"
                           ]
                        }
                     ],
                     "encoding":{
                        "x":{
                           "field":"regress-x",
                           "type":"quantitative",
                           "axis":{
                              "title":null
                           },
                           "scale":{
                              "type":"sqrt"
                           }
                        },
                        "y":{
                           "field":"regress-y",
                           "type":"quantitative",
                           "axis":{
                              "grid":false
                           },
                           "scale":{
                              "zero":false
                           }
                        }
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  },
                  {
                     "mark":{
                        "type":"text",
                        "x":"width",
                        "y":-5,
                        "align":"right"
                     },
                     "data":{
                        "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/cleaned_wdi_economic_output_breakup.csv",
                        "format":{
                           "type":"csv",
                           "parse":{
                              "Year":"number",
                              "GDP":"number",
                              "Industry":"number",
                              "Manufacturing":"number"
                           }
                        }
                     },
                     "transform":[
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/countries.csv",
                                 "format":{
                                    "type":"csv"
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "income-group",
                                 "region"
                              ]
                           }
                        },
                        {
                           "lookup":"Country Code",
                           "from":{
                              "data":{
                                 "url":"https://raw.githubusercontent.com/joel-brand/FIT3179/main/data/economic_fitness_2014.csv",
                                 "format":{
                                    "type":"csv",
                                    "parse":{
                                       "economic-fitness":"number"
                                    }
                                 }
                              },
                              "key":"country-code",
                              "fields":[
                                 "economic-fitness"
                              ]
                           }
                        },
                        {
                           "filter":"datum.Year == 2014 && datum.Agriculture != 0 && datum.Agriculture != null&& datum[\"income-group\"] != null"
                        },
                        {
                           "regression":"Agriculture",
                           "on":"economic-fitness",
                           "params":true
                        },
                        {
                           "calculate":"'R²: '+format(datum.rSquared, '.2f')",
                           "as":"R2"
                        }
                     ],
                     "encoding":{
                        "text":{
                           "field":"R2",
                           "type":"nominal"
                        }
                     },
                     "title":null,
                     "width":400,
                     "height":300
                  }
               ]
            }
         ]
      }
   ],
   "title":{
      "text":"Sector % of GDP vs Economic Fitness",
      "subtitle":"Bigger bubbles have larger GDP"
   }
}